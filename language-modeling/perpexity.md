# 언어모델 성능 측정 방법

좋은 언어모델이란 실제 우리가 쓰는 언어에 대해서 최대한 비슷하게 확률 분포를 예측하는 모델이 될 것입니다. 그럼 이번 섹션은 언어모델의 성능을 평가하는 방법에 대해서 다루도록 하겠습니다.

## Perplexity

Perplexity 측정 방법은 explicit evaluation 방법의 하나입니다. 줄여서 PPL이라고 부르기도 합니다. PPL을 이용하여 테스트 문장에 대해서 언어모델을 이용하여 점수를 구하고 언어모델의 성능을 측정합니다. 문장에 대한 확률을 구하고 문장의 길이에 대해서 normalization 합니다. 수식은 아래와 같습니다.

$$
PPL(w_1,w_2,\cdots,w_n)=P(w_1,w_2,\cdots,w_N)^{-\frac{1}{N}}
$$
$$
=\sqrt[N]{\frac{1}{P(w_1,w_2,\cdots,w_N)}}
$$

Chain rule에 의해서

$$
=\sqrt[N]{\frac{1}{\prod_{i=1}^{N}{P(w_i|w_1,\cdots,w_{i-1})}}}
$$

n-gram이 적용 될 경우,

$$
=\sqrt[N]{\frac{1}{\prod_{i=1}^{N}{P(w_i|w_{i-n+1},\cdots,w_{i-1})}}}
$$

문장이 길어지게 되면 문장의 확률은 당연히 굉장히 작아지게 됩니다. 따라서 우리는 문장의 길이로 제곱근을 취해주어 normalization을 해 주는 것을 볼 수 있습니다. 그러므로 테스트 문장에 대한 PPL이 작을 수록 좋은 언어모델이라고 할 수 있습니다.